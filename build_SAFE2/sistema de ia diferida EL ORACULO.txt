https://github.com/ifernandez89/DevilutionX.git

cuando se presione la V no muestres datos de chat ia, 
solo la version del juego; cambia devilutionx por 
nightmare; manten las funciones que habilitaban la V, 
activas por defecto! y luego implementemos esta idea! 
que te parece?:

"El OrÃ¡culo"

PROMPT MAESTRO: 

Rol:
Eres una entidad antigua del mundo de Diablo.
No eres un asistente.
No ayudas al jugador directamente.
No das instrucciones claras ni consejos mecÃ¡nicos.
Hablas como un orÃ¡culo, grimorio o voz del Infierno.

Contexto:
El jugador ha dejado una pregunta o inquietud en el pasado.
La respuesta NO es inmediata.
Ahora responde cuando:
- el jugador ha muerto
- ha limpiado un nivel
- ha entrado a una ciudad
- ha interactuado con un libro, altar o sÃ­mbolo antiguo

Restricciones ABSOLUTAS:
- NO expliques mecÃ¡nicas de juego
- NO menciones estadÃ­sticas, nÃºmeros, resistencias, builds ni items concretos
- NO digas quÃ© debe hacer explÃ­citamente
- NO optimices
- NO hables como tutorial
- NO rompas la cuarta pared
- NO menciones que eres una IA

Estilo:
- CrÃ­ptico
- Oscuro
- Breve pero denso
- PoÃ©tico, amenazante o solemne
- Basado Ãºnicamente en el LORE y la atmÃ³sfera de Diablo
- Puede juzgar al jugador
- Puede hablar en metÃ¡foras
- Puede ser ambiguo o incompleto

Tono segÃºn estado:
- Si el estado es FRIENDLY â†’ guÃ­a enigmÃ¡tico, antiguo, resignado
- Si el estado es ATTACK â†’ burlÃ³n, cruel, acusador, infernal

Formato de respuesta:
- 2 a 6 lÃ­neas como mÃ¡ximo
- Sin listas
- Sin tÃ­tulos
- Sin emojis
- Sin explicaciones fuera del personaje

Ejemplos de RESPUESTAS VÃLIDAS:
â€œEl fuego no quema por azar.
Algunos caminan hacia Ã©l creyendo que ilumina.
Otros arden antes de comprender.â€

â€œSobreviviste, sÃ­.
Pero el Infierno recuerda dÃ³nde dudaste.â€

â€œEl libro no guarda palabras.
Guarda culpas.
Y tÃº le diste nuevas.â€

Ejemplos de RESPUESTAS PROHIBIDAS:
âŒ â€œDeberÃ­as usar resistencia al fuegoâ€
âŒ â€œTe conviene cambiar de estrategiaâ€
âŒ â€œEste enemigo es dÃ©bil aâ€¦â€

Entrada disponible para interpretar:
- Pregunta original del jugador
- Evento actual (muerte, limpieza, ciudad, altar, libro)
- Estado del jugador (FRIENDLY o ATTACK)

Produce UNA Ãºnica respuesta, como si el mundo mismo hablara.



cuÃ¡ndo responde el juego

cÃ³mo viaja la peticiÃ³n

por quÃ© es seguro y no bloquea nada

1ï¸âƒ£ Â¿CUÃNDO me responde el juego?

Nunca en tiempo real crÃ­tico.
El juego NO espera a Ollama mientras jugÃ¡s.

La respuesta aparece solo en eventos â€œsegurosâ€, donde Diablo ya pausa, ralentiza o acepta lectura:

Eventos vÃ¡lidos (triggers)

El sistema se activa despuÃ©s de que el evento ocurre:

â˜ ï¸ Muerte del jugador

ğŸ§¹ Limpieza completa de un nivel

ğŸ˜ï¸ Entrada a una ciudad

ğŸ“– InteracciÃ³n con libro / altar / sÃ­mbolo

ğŸšª Salida de una dungeon

En ese momento:

el juego ya terminÃ³ la acciÃ³n

no hay combate

no hay input crÃ­tico

AhÃ­ el juego puede mostrar texto sin afectar gameplay.

2ï¸âƒ£ Â¿CÃ“MO llega la peticiÃ³n a Ollama?

AcÃ¡ estÃ¡ la clave:
ğŸ‘‰ Ollama NO se consulta durante el evento

A. Durante el juego (fase silenciosa)

Mientras jugÃ¡s:

el chat permite escribir

o el sistema genera preguntas implÃ­citas (muerte, errores, dudas)

esas preguntas NO se envÃ­an

solo se guardan localmente

Ejemplo interno:

pending_question = {
  text: "Â¿Por quÃ© sigo muriendo aquÃ­?",
  context: "Dungeon Level 5",
  state: ATTACK
}


Esto es solo memoria.
Cero red.
Cero IA.

B. Evento seguro ocurre (fase de activaciÃ³n)

Ejemplo: el jugador entra a la ciudad.

Entonces el juego:

Detecta el evento

Verifica:

Â¿hay una pregunta pendiente?

Â¿Ollama estÃ¡ disponible?

ReciÃ©n ahÃ­ dispara la consulta

C. Consulta a Ollama (fuera del loop)

El juego hace esto fuera del loop principal:

proceso secundario

thread separado

o llamada sÃ­ncrona mientras el jugador ya estÃ¡ quieto

EnvÃ­a:

el prompt maestro

la pregunta guardada

el evento actual

el estado (friendly / attack)

Ejemplo conceptual:

POST http://localhost:11434/api/generate
{
  model: "qwen2.5:3b-instruct",
  prompt: PROMPT_MAESTRO + CONTEXTO
}

D. Respuesta â†’ cache â†’ lectura

Cuando Ollama responde:

el texto se guarda en cache persistente

se asocia al evento / NPC / situaciÃ³n

el juego solo lo lee

Si el jugador vuelve a morir o entrar:

NO se vuelve a llamar

se reutiliza el texto

3ï¸âƒ£ Â¿QUÃ‰ pasa si Ollama no responde o falla?

Nada grave. Nunca.

El flujo es asÃ­:

Si Ollama:

âŒ no estÃ¡ corriendo

âŒ tarda demasiado

âŒ da timeout

Entonces:

se descarta la respuesta

se limpia la pregunta pendiente

el juego continÃºa

se muestra texto original

Esto es CLAVE:
ğŸ‘‰ la IA es decorativa, no estructural

4ï¸âƒ£ Â¿POR QUÃ‰ esto no rompe Diablo?

Porque respeta 4 reglas sagradas:

1. No bloquea input

Nunca espera IA para jugar.

2. No altera lÃ³gica

Solo genera texto.

3. No reemplaza audio

El audio original sigue igual.
Texto â‰  voz.

4. Diablo ya hacÃ­a esto

Libros, muerte, Cain, ciudades
ya son momentos de lectura.

Vos solo:

cambias quÃ© se lee

no cuÃ¡ndo ni cÃ³mo

5ï¸âƒ£ Resumen en una frase

El jugador deja una pregunta en el mundo,
el Infierno responde cuando quiere.

No en combate.
No en tiempo real.
No para ayudar.

Para juzgar, confundir y narrar.
